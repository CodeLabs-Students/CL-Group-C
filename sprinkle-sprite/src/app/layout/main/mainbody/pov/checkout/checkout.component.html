<main class="checkout-hero">
  <div class="checkout-body">


    <!------- LEFT COLUMN: Message + Seasonal Items List ------->

    <div class="checkout-left">

      <!-- Thank-you message shown at the top of checkout view -->
      <section class="thank-you">
        <h2>THANK YOU FOR<br />SHOPPING WITH US</h2>
        <p>
          You just made our day a little sweeter.<br />
          Come back soon! <br />
          We’re always scooping up something magical!
        </p>
      </section>

      <!-- If seasonalItems exists, render the list -->
      @if (seasonalItems.length > 0) {

        <div class="checkout-items">

          <!-- Render each seasonal card from shared card list -->
          @for (card of seasonalItems; track card.id) {

            <div
              class="checkout-card"
              [class.expanded]="card.expanded"
              (click)="cardService.toggleCard(card)"
            >

              <!-- Display the card title and description -->
              <h3 [title]="card.title">{{ card.title }}</h3>
              <p [title]="card.description">{{ card.description }}</p>

              <!-- Show expanded card info if clicked -->
              @if (card.expanded) {
                <div class="expanded-info">

                  <!-- Price and rarity breakdown -->
                  <p><strong>Price:</strong> ${{ card.price }}</p>
                  <p><strong>Rarity:</strong> {{ card.rarity }}</p>

                  <!-- Display icon for the rarity type -->
                  @if (card.rarity === 'Uncommon') {
                    <img class="icon" src="assets/resources/vip_Icons/uncommon_Icon.png" alt="Uncommon" />
                  }
                  @else if (card.rarity === 'Common') {
                    <img class="icon" src="assets/resources/vip_Icons/common_Icon.png" alt="Common" />
                  }
                  @else if (card.rarity === 'Legendary') {
                    <img class="icon" src="assets/resources/vip_Icons/legendary_Icon.png" alt="Legendary" />
                  }
                  @else if (card.rarity === 'Rare') {
                    <img class="icon" src="assets/resources/vip_Icons/rare_icon.png" alt="Rare" />
                  }
                  @else if (card.rarity === 'Seasonal') {
                    <img class="icon" src="assets/resources/vip_Icons/seasonal_Icon.png" alt="Seasonal" />
                  }
                </div>
              }

              <!-- Quantity control buttons -->
              <div class="card-controls" (click)="$event.stopPropagation()">
                <button (click)="cardService.decrease(card)" [disabled]="card.count === 0">−</button>
                <span>{{ card.count }}</span>
                <button (click)="cardService.increase(card)">+</button>
                <button class="checkout-button">Add to cart</button>
              </div>

            </div>
          }
        </div>
      }

      <!-- If there are no seasonal items, show fallback message -->
      @else {
        <p>No seasonal items available.</p>
      }

    </div>


    <!------- RIGHT COLUMN: Summary / Totals Panel ------->

    <section class="summary">
      <h3>CHECKOUT</h3>

      <!-- Total item count and subtotal -->
      <div class="summary-line">
        <p>ITEMS:</p>
        <span>{{ totalCount() }} item(s) at {{ total() | currency }}</span>
        @for (items of cartItems(); track items.name) {
          <p>{{ items.name }}: {{ items.count }}</p>
        }
      </div>

      <!-- Tax amount based on fixed rate -->
      <div class="summary-line">
        <p>TAXES:</p>
        <span>{{ tax() | currency }}</span>
      </div>

      <!-- Flat shipping cost (currently free) -->
      <div class="summary-line">
        <p>SHIPPING:</p>
        <span>$0.00</span>
      </div>

      <!-- Combined total (subtotal + tax) -->
      <div class="summary-line total">
        <p>TOTAL:</p>
        <span>{{ total | currency }}</span>
      </div>

      <hr />

      <!-- Grand total repeated for emphasis -->
      <div class="summary-line grand-total">
        <p>TOTAL:</p>
        <span>{{ total | currency }}</span>
      </div>

      <!-- Final checkout button -->
      <div class="checkout-btn-wrapper">
        <button class="checkout-now">CHECKOUT NOW</button>
      </div>

    </section>

  </div>
</main>
